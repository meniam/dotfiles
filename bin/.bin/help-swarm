#! /bin/bash

GREEN="\033[1;32m"
CYAN="\033[1;36m"
YELLOW="\033[1;33m"
NC="\033[0m"

print_section() {
  echo -e "\n${CYAN}== $1 ==${NC}"
}

print_cmd() {
  echo -e "${GREEN}$1${NC}"
  [ -n "$2" ] && echo -e "   $2"
}

echo -e "${YELLOW}Docker Swarm Cheat Sheet üê≥${NC}"

print_section "üìå –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Swarm"
print_cmd "docker swarm init --advertise-addr <IP>" "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞"

print_section "üìå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É–∑–ª–æ–≤"
print_cmd "docker swarm join --token <worker_token> <manager_ip>:2377" "–ü–æ–¥–∫–ª—é—á–∏—Ç—å worker-—É–∑–µ–ª"
print_cmd "docker swarm join --token <manager_token> <manager_ip>:2377" "–ü–æ–¥–∫–ª—é—á–∏—Ç—å manager-—É–∑–µ–ª"
print_cmd "docker swarm join-token worker" "–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω worker"
print_cmd "docker swarm join-token manager" "–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω manager"

print_section "üì¶ –°–µ—Ä–≤–∏—Å—ã –∏ Stack"
print_cmd "docker stack deploy -c docker-compose.yml <stack>" "–ó–∞–ø—É—Å–∫ stack"
print_cmd "docker stack rm <stack>" "–£–¥–∞–ª–µ–Ω–∏–µ stack"
print_cmd "docker service ls" "–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤"
print_cmd "docker service ps <—Å–µ—Ä–≤–∏—Å>" "–ó–∞–¥–∞—á–∏ —Å–µ—Ä–≤–∏—Å–∞"
print_cmd "docker service logs <—Å–µ—Ä–≤–∏—Å>" "–õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞"
print_cmd "docker service scale <—Å–µ—Ä–≤–∏—Å>=<–∫–æ–ª-–≤–æ>" "–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"
print_cmd "docker service update --force <—Å–µ—Ä–≤–∏—Å>" "–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç"

print_section "üîó –°–µ—Ç–∏"
print_cmd "docker network create --driver overlay --attachable traefik-public" "–°–æ–∑–¥–∞–Ω–∏–µ overlay-—Å–µ—Ç–∏ –¥–ª—è Traefik"

print_section "üìã –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
print_cmd "docker node ls" "–°–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤"
print_cmd "docker node inspect <node> --pretty" "–ò–Ω—Ñ–æ –æ–± —É–∑–ª–µ"
print_cmd "docker info" "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —É–∑–ª–µ"

print_section "üîß –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –ª–æ–≥–∏"
print_cmd "docker ps" "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–∞ —Ç–µ–∫—É—â–µ–º —É–∑–ª–µ"
print_cmd "docker logs <container_id>" "–õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞"
print_cmd "docker inspect <id>" "–ò–Ω—Ñ–æ –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ/—Å–µ—Ä–≤–∏—Å–µ"

print_section "üö™ –£–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–∞"
print_cmd "docker swarm leave" "–ü–æ–∫–∏–Ω—É—Ç—å –∫–ª–∞—Å—Ç–µ—Ä (worker)"
print_cmd "docker swarm leave --force" "–ü–æ–∫–∏–Ω—É—Ç—å –∫–ª–∞—Å—Ç–µ—Ä (manager)"

print_section "‚ö†Ô∏è –£–∑–µ–ª –≤ drain"
print_cmd "docker node update --availability drain <node>" "–£–±—Ä–∞—Ç—å —É–∑–µ–ª –∏–∑ –ø—É–ª–∞"

echo -e "\n${YELLOW}–ì–æ—Ç–æ–≤–æ!${NC} üöÄ"
